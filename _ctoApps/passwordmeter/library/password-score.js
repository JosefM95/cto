function Keyboard(l,t){this.keyboard=l,this.averageNeighbours=t,this.areAdjacent=function(l,t){if(l in this.keyboard)for(var n=0;n<this.keyboard[l].length;n++)if(null!==this.keyboard[l][n]&&this.keyboard[l][n].indexOf(t)>=0)return!0;return!1}}function Score(l){this.password=l}Score.prototype={constructor:Score,LOWER:26,UPPER:26,NUMBER:10,PUNCTUATION:34,DAYS:31,MONTHS:31,YEARS:2e3,sequences:{lower:"abcdefghijklmnopqrstuvwxyz",numbers:"01234567890"},leet:{1:["i","l"],2:["n","r","z"],3:["e"],4:["a"],5:["s"],6:["g"],7:["t"],8:["b"],9:["g","o"],0:["o"],"@":["a"],"(":["c"],"[":["c"],"<":["c"],"&":["g"],"!":["i"],"|":["i","l"],"?":["n","r"],$:["s"],"+":["t"],"%":["x"]},regex:{repetition:{single:/(.)\1+/g,group:/(..+)\1+/g},date:{DMY:/(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])([\- \/.])?([0-9]{2})/g,DMYY:/(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])([\- \/.])?([0-9]{4})/g,MDY:/(0?[1-9]|1[012])([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?([0-9]{2})/g,MDYY:/(0?[1-9]|1[012])([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?([0-9]{4})/g,YDM:/([0-9]{2})([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])/g,YYDM:/([0-9]{4})([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])/g,YMD:/([0-9]{2})([\- \/.])?(0?[1-9]|1[012])([\- \/.])?(([0-9]{2})?[0-9]{2})(0?[1-9]|[12][0-9]|3[01])/g,YYMD:/([0-9]{4})([\- \/.])?(0?[1-9]|1[012])([\- \/.])?(([0-9]{2})?[0-9]{2})(0?[1-9]|[12][0-9]|3[01])/g,DM:/(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])/g,MY:/(0?[1-9]|1[012])([\- \/.])?([0-9]{2})/g,MYY:/(0?[1-9]|1[012])([\- \/.])?([0-9]{4})/g},number:/[0-9]+/,numberOnly:/^[0-9]+$/,punctuation:/[\^°!"§\$%&\/\(\)=\?\\\.:,;\-_#'\+~\*<>\|\[\]\{\}`´]+/,punctuationOnly:/^[\^°!"§\$%&\/\(\)=\?\\\.:,;\-_#'\+~\*<>\|\[\]\{\}`´]+$/,lower:/[a-z]+/,lowerOnly:/^[a-z]+$/,upper:/[A-Z]+/,upperOnly:/^[A-Z]+$/,upperFirst:/^[A-Z]+[A-Za_z]*$/,upperFirstOnly:/^[A-Z]{1}[a-z]+$/},keyboards:{QWERTZ:new Keyboard({"^":[null,null,null,"^°","1!",null,null],"°":[null,null,null,"^°","1!",null,null],1:[null,null,"^°","1!",'2"',null,"qQ@"],"!":[null,null,"^°","1!",'2"',null,"qQ@"],2:[null,null,"1!",'2"',"3§","qQ@","wW"],'"':[null,null,"1!",'2"',"3§","qQ@","wW"],3:[null,null,'2"',"3§","4$","wW","eE€"],"§":[null,null,'2"',"3§","4$","wW","eE€"],4:[null,null,"3§","4$","5%","eE€","rR"],$:[null,null,"3§","4$","5%","eE€","rR"],5:[null,null,"4$","5%","6&","rR","tT"],"%":[null,null,"4$","5%","6&","rR","tT"],6:[null,null,"5%","6&","7/{","tT","yY"],"&":[null,null,"5%","6&","7/{","tT","yY"],7:[null,null,"6&","7/{","8([","yY","uU"],"/":[null,null,"6&","7/{","8([","yY","uU"],"{":[null,null,"6&","7/{","8([","yY","uU"],8:[null,null,"7/{","8([","9)]","uU","iI"],"(":[null,null,"7/{","8([","9)]","uU","iI"],"[":[null,null,"7/{","8([","9)]","uU","iI"],9:[null,null,"8([","9)]","0=}","iI","oO"],")":[null,null,"8([","9)]","0=}","iI","oO"],"]":[null,null,"8([","9)]","0=}","iI","oO"],0:[null,null,"9)]","0=}","ß?\\","oO","pP"],"=":[null,null,"9)]","0=}","ß?\\","oO","pP"],"}":[null,null,"9)]","0=}","ß?\\","oO","pP"],"ß":[null,null,"0=}","ß?\\","´`","pP","üÜ"],"?":[null,null,"0=}","ß?\\","´`","pP","üÜ"],"\\":[null,null,"0=}","ß?\\","´`","pP","üÜ"],"`":[null,null,"ß?\\","´`",null,"üÜ","+*~"],"´":[null,null,"ß?\\","´`",null,"üÜ","+*~"],q:["1!",'2"',null,"qQ@","wW",null,"aA"],Q:["1!",'2"',null,"qQ@","wW",null,"aA"],"@":["1!",'2"',null,"qQ@","wW",null,"aA"],w:['2"',"3§","qQ@","wW","eE€","aA","sS"],W:['2"',"3§","qQ@","wW","eE€","aA","sS"],e:["3§","4$","wW","eE€","rR","sS","dD"],E:["3§","4$","wW","eE€","rR","sS","dD"],"€":["3§","4$","wW","eE€","rR","sS","dD"],r:["4$","5%","eE€","rR","tT","dD","fF"],R:["4$","5%","eE€","rR","tT","dD","fF"],t:["5%","6&","rR","tT","zZ","fF","gG"],T:["5%","6&","rR","tT","zZ","fF","gG"],z:["6&","7/{","tT","zZ","uU","gG","hH"],Z:["6&","7/{","tT","zZ","uU","gG","hH"],u:["7/{","8([","zZ","uU","iI","hH","jJ"],U:["7/{","8([","zZ","uU","iI","hH","jJ"],i:["8([","9)]","uU","iI","oO","jJ","kK"],I:["8([","9)]","uU","iI","oO","jJ","kK"],o:["9)]","0=}","iI","oO","pP","kK","lL"],O:["9)]","0=}","iI","oO","pP","kK","lL"],p:["0=}","ß?\\","oO","pP","üÜ","lL","öÖ"],P:["0=}","ß?\\","oO","pP","üÜ","lL","öÖ"],"ü":["ß?\\","´`","pP","üÜ","+*~","öÖ","äÄ"],"Ü":["ß?\\","´`","pP","üÜ","+*~","öÖ","äÄ"],"+":["´``",null,"üÜ","+*~",null,"äÄ","'#"],"*":["´``",null,"üÜ","+*~",null,"äÄ","'#"],"~":["´``",null,"üÜ","+*~",null,"äÄ","'#"],a:["qQ@","wW",null,"aA","sS","<>|","yY"],A:["qQ@","wW",null,"aA","sS","<>|","yY"],s:["wW","eE€","aA","sS","dD","yY","xX"],S:["wW","eE€","aA","sS","dD","yY","xX"],d:["eE€","rR","sS","dD","fF","xX","cC"],D:["eE€","rR","sS","dD","fF","xX","cC"],f:["rR","tT","dD","fF","gG","cC","vV"],F:["rR","tT","dD","fF","gG","cC","vV"],g:["tT","zZ","fF","gG","hH","vV","bB"],G:["tT","zZ","fF","gG","hH","vV","bB"],h:["zZ","uU","gG","hH","jJ","bB","nN"],H:["zZ","uU","gG","hH","jJ","bB","nN"],j:["uU","iI","hH","jJ","kK","nN","mM"],J:["uU","iI","hH","jJ","kK","nN","mM"],k:["iI","oO","jJ","kK","lL","mM",",;"],K:["iI","oO","jJ","kK","lL","mM",",;"],l:["oO","pP","kK","lL","öÖ",",;",".:"],L:["oO","pP","kK","lL","öÖ",",;",".:"],"ö":["pP","üÜ","lL","öÖ","äÄ",".:","-_"],"Ö":["pP","üÜ","lL","öÖ","äÄ",".:","-_"],"ä":["üÜ","+*~","öÖ","äÄ","#'","-_",null],"Ä":["üÜ","+*~","öÖ","äÄ","#'","-_",null],"#":["+*~",null,"äÄ","#'",null,null,null],"'":["+*~",null,"äÄ","#'",null,null,null],"<":[null,"aA",null,"<>|","yY",null,null],">":[null,"aA",null,"<>|","yY",null,null],"|":[null,"aA",null,"<>|","yY",null,null],y:["aA","sS","<>|","yY","xX",null,null],Y:["aA","sS","<>|","yY","xX",null,null],x:["sS","dD","yY","xX","cC",null,null],X:["sS","dD","yY","xX","cC",null,null],c:["dD","fF","xX","cC","vV",null,null],C:["dD","fF","xX","cC","vV",null,null],v:["fF","gG","cC","vV","bB",null,null],V:["fF","gG","cC","vV","bB",null,null],b:["gG","hH","vV","bB","nN",null,null],B:["gG","hH","vV","bB","nN",null,null],n:["hH","jJ","bB","nN","mM",null,null],N:["hH","jJ","bB","nN","mM",null,null],m:["jJ","kK","nN","mM",",;",null,null],M:["jJ","kK","nN","mM",",;",null,null],",":["kK","lL","mM",",;",".:",null,null],";":["kK","lL","mM",",;",".:",null,null],".":["lL","öÖ",",;",".:","-_",null,null],":":["lL","öÖ",",;",".:","-_",null,null],"-":["öÖ","ä",".:","-_",null,null,null],_:["öÖ","ä",".:","-_",null,null,null]},4.571428571),QWERTY:new Keyboard({"~":[null,null,null,"~`","1!",null,null],"`":[null,null,null,"~`","1!",null,null],1:[null,null,"`~","1!","2@",null,"qQ"],"!":[null,null,"`~","1!","2@",null,"qQ"],2:[null,null,"1!","2@","3#","qQ","wW"],"@":[null,null,"1!","2@","3#","qQ","wW"],3:[null,null,"2@","3#","4$","wW","eE"],"#":[null,null,"2@","3#","4$","wW","eE"],4:[null,null,"3#","4$","5%","eE","rR"],$:[null,null,"3#","4$","5%","eE","rR"],5:[null,null,"4$","5%","6^","rR","tT"],"%":[null,null,"4$","5%","6^","rR","tT"],6:[null,null,"5%","6^","7&","tT","yY"],"^":[null,null,"5%","6^","7&","tT","yY"],7:[null,null,"6^","7&","8*","yY","uU"],"&":[null,null,"6^","7&","8*","yY","uU"],8:[null,null,"7&","8*","9(","uU","iI"],"*":[null,null,"7&","8*","9(","uU","iI"],9:[null,null,"8*","9(","0)","iI","oO"],"(":[null,null,"8*","9(","0)","iI","oO"],0:[null,null,"9(","0)","-_","oO","pP"],")":[null,null,"9(","0)","-_","oO","pP"],"-":[null,null,"0)","-_","=+","pP","[{"],_:[null,null,"0)","-_","=+","pP","[{"],"=":[null,null,"-_","=+","\\|","{[","}]"],"+":[null,null,"-_","=+","\\|","{[","}]"],"\\":[null,null,"=+","\\|",null,"}]",null],"|":[null,null,"=+","\\|",null,"}]",null],q:["1!","2@",null,"qQ","wW",null,"aA"],Q:["1!","2@",null,"qQ","wW",null,"aA"],w:["2@","3#","qQ","wW","eE","aA","sS"],W:["2@","3#","qQ","wW","eE","aA","sS"],e:["3#","4$","wW","eE","rR","sS","dD"],E:["3#","4$","wW","eE","rR","sS","dD"],r:["4$","5%","eE","rR","tT","dD","fF"],R:["4$","5%","eE","rR","tT","dD","fF"],t:["5%","6^","rR","tT","yY","fF","gG"],T:["5%","6^","rR","tT","yY","fF","gG"],y:["6^","7&","tT","yY","uU","gG","hH"],Y:["6^","7&","tT","yY","uU","gG","hH"],u:["7&","8*","yY","uU","iI","hH","jJ"],U:["7&","8*","yY","uU","iI","hH","jJ"],i:["8*","9(","uU","iI","oO","jJ","kK"],I:["8*","9(","uU","iI","oO","jJ","kK"],o:["9(","0)","iI","oO","pP","kK","lL"],O:["9(","0)","iI","oO","pP","kK","lL"],p:["0)","-_","oO","pP","[{","lL",":;"],P:["0)","-_","oO","pP","[{","lL",":;"],"[":["-_","=+","pP","[{","]}",":;","'\""],"{":["-_","=+","pP","[{","]}",":;","'\""],"]":["=+","\\|","[{","]}",null,"'\"",null],"}":["=+","\\|","[{","]}",null,"'\"",null],a:["qQ","wW",null,"aA","sS",null,"zZ"],A:["qQ","wW",null,"aA","sS",null,"zZ"],s:["wW","eE","aA","sS","dD","zZ","xX"],S:["wW","eE","aA","sS","dD","zZ","xX"],d:["eE","rR","sS","dD","fF","xX","cC"],D:["eE","rR","sS","dD","fF","xX","cC"],f:["rR","tT","dD","fF","gG","cC","vV"],F:["rR","tT","dD","fF","gG","cC","vV"],g:["tT","yY","fF","gG","hH","vV","bB"],G:["tT","yY","fF","gG","hH","vV","bB"],h:["yY","uU","gG","hH","jJ","bB","nN"],H:["yY","uU","gG","hH","jJ","bB","nN"],j:["uU","iI","hH","jJ","kK","nN","mM"],J:["uU","iI","hH","jJ","kK","nN","mM"],k:["iI","oO","jJ","kK","lL","mM",",;"],K:["iI","oO","jJ","kK","lL","mM",",;"],l:["oO","pP","kK","lL",":;",",<",".>"],L:["oO","pP","kK","lL",":;",",<",".>"],":":["pP","[{","lL",":;","'\"",".>","?/"],";":["pP","[{","lL",":;","'\"",".>","?/"],"'":["[{","]}",":;","'\"",null,"?/",null],'"':["[{","]}",":;","'\"",null,"?/",null],z:["aA","sS",null,"zZ","xX",null,null],Z:["aA","sS",null,"zZ","xX",null,null],x:["sS","dD","zZ","xX","cC",null,null],X:["sS","dD","zZ","xX","cC",null,null],c:["dD","fF","xX","cC","vV",null,null],C:["dD","fF","xX","cC","vV",null,null],v:["fF","gG","cC","vV","bB",null,null],V:["fF","gG","cC","vV","bB",null,null],b:["gG","hH","vV","bB","nN",null,null],B:["gG","hH","vV","bB","nN",null,null],n:["hH","jJ","bB","nN","mM",null,null],N:["hH","jJ","bB","nN","mM",null,null],m:["jJ","kK","nN","mM",",<",null,null],M:["jJ","kK","nN","mM",",<",null,null],",":["kK","lL","mM",",<",".>",null,null],"<":["kK","lL","mM",",<",".>",null,null],".":["lL",":;",",<",".>","/?",null,null],">":["lL",":;",",<",".>","/?",null,null],"/":[":;","'\"",".>","/?",null,null,null],"?":[":;","'\"",".>","/?",null,null,null]},4.571428571),QWERTZNumpad:new Keyboard({0:["1","2",",",null],",":["3","0",null,null],1:["4",null,"2","0"],2:["5","1","3","0"],3:["3","2",null,","],4:["7",null,"5","1"],5:["8","4","6","2"],6:["9","5","6","2"],7:[null,null,"8","4"],8:["/","7","9","5"],9:["*","8","+","6"],"+":["-","9","6",null],"/":[null,null,"*","8"],"*":[null,"/","-","9"],"-":[null,"*",null,"+"]},3),QWERTYNumpad:new Keyboard({0:["1","2",",",null],",":["3","0",null,null],1:["4",null,"2","0"],2:["5","1","3","0"],3:["6","2",null,","],4:["7",null,"5","1"],5:["8","4","6","2"],6:["9","5","+","2"],7:[null,null,"8","4"],8:["/","7","9","5"],9:["*","8","+","6"],"+":["-","9","6",null],"/":[null,null,"*","8"],"*":[null,"/","-","9"],"-":[null,"*",null,"+"]},3)},cache:{clear:function(){for(var l in this)"set"!==l&&"clear"!==l&&(this[l]=void 0)},set:function(l,t){this[l]=t}},lg:function(l){return Math.log(l)/Math.log(2)},calculateAverageTimeToCrack:function(l,t){return.5*Math.pow(2,l)*.005/t},calculateBruteForceEntropy:function(){var l=0;this.regex.lower.test(this.password)&&(l+=this.LOWER),this.regex.upper.test(this.password)&&(l+=this.UPPER),this.regex.number.test(this.password)&&(l+=this.NUMBER),this.regex.punctuation.test(this.password)&&(l+=this.PUNCTUATION);var t=this.lg(l)*this.password.length;return this.cache.set("naiveEntropy",t),t},collectMatches:function(l,t){l=void 0===l?[]:l,!0===(t=void 0===t||t)&&void 0!==this.options&&(l=l.concat(this.options));for(var n=[],e=0;e<l.length;e++){var u=[];if(!(!1 in l[e])){switch(l[e].type){case"dictionary":if("dictionary"in l[e]&&(u=this.collectDictionaryMatches(l[e].dictionary),"leet"in l[e]&&!0===l[e].leet)){var r=this.collectLeetSpeakMatches(l[e].dictionary);u=u.concat(r)}break;case"keyboard":"keyboard"in l[e]&&(u=this.collectKeyboardMatches(l[e].keyboard));break;case"repetition":u=this.collectRepetitionMatches();break;case"sequences":u=this.collectSequenceMatches();break;case"dates":u=this.collectDateMatches()}"key"in l[e]&&this.cache.set(l[e].key,u),n=n.concat(u)}}return n},calculateEntropyScore:function(l,t){for(var n=this.collectMatches(l,t),e=[],u=[],r=this.calculateBruteForceEntropy(this.password),s=0;s<this.password.length;s++){n[n.length]={pattern:this.password[s],entropy:this.calculateBruteForceEntropy(this.password[s]),start:s,end:s,type:"letter"},e[s]=Number.POSITIVE_INFINITY;for(var i=0;i<n.length;i++){var a=n[i].start;if(n[i].end===s){var r=n[i].entropy;a>0&&(r+=e[a-1]),r<e[s]&&(e[s]=r,u[s]=n[i])}}}for(var h=[],s=this.password.length-1;s>=0;)u[s]?(h[h.length]=u[s],s=u[s].start-1):s--;return this.cache.set("minimumMatches",h),this.cache.set("entropy",e[this.password.length-1]),e[this.password.length-1]},collectDictionaryMatches:function(l){for(var t=[],n=0;n<this.password.length;n++)for(var e=n;e<this.password.length;e++){var u=this.password.substring(n,e+1),r=u.toLowerCase(),s=this.getReversedString(r);r in l&&l[r]&&(t[t.length]={pattern:u,entropy:this.calculateDictionaryEntropy(u,r,l[r]),start:n,end:e,type:"dictionary"}),s in l&&l[s]&&(t[t.length]={pattern:u,entropy:this.calculateReversedDictionaryEntropy(u,r,l[r]),start:n,end:e,type:"dictionary"})}return t},calculateDictionaryEntropy:function(l,t,n){return this.regex.lower.test(l)&&this.regex.upper.test(l)?this.regex.upperFirstOnly.test(l)?this.lg(n)+1:this.lg(n)+l.length:this.lg(n)},calculateReversedDictionaryEntropy:function(l,t,n){return this.calculateDictionaryEntropy(l,t,n)+1},collectLeetSpeakMatches:function(l){for(var t=[],n=this.collectLeetSpeakSubstitutions(this.password),e=0;e<n.length;e++)for(var u=0;u<n[e].length;u++)for(var r=u;r<n[e].length;r++){var s=n[e].substring(u,r+1),i=s.toLowerCase(),a=this.getReversedString(i),h=this.password.substring(u,r+1);i in l&&l[i]&&(t[t.length]={pattern:h,entropy:this.calculateLeetSpeakEntropy(this.password.substring(u,r+1),i,l[i]),start:u,end:r,type:"leet"}),a in l&&l[i]&&(t[t.length]={pattern:h,entropy:this.calculateReversedLeetSpeakEntropy(this.password.substring(u,r+1),i,l[i]),start:u,end:r,type:"leet"})}return t},calculateLeetSpeakEntropy:function(l,t,n){var e=1;for(var u in this.leet)l.indexOf(u)>=0&&(e*=this.leet[u].length+1);return this.calculateDictionaryEntropy(l,t,n)+this.lg(e)},calculateReversedLeetSpeakEntropy:function(l,t,n){return this.calculateLeetSpeakEntropy(l,t,n)+1},collectLeetSpeakSubstitutions:function(){var l={};for(var t in this.leet)this.password.indexOf(t)>=0&&(l[t]=this.leet[t]);var n=function(t){if(t[0]in l){if(1===t.length)return l[t[0]];for(var e=n(t.substring(1,t.length)),u=[],r=0;r<e.length;r++)for(var s=0;s<l[t[0]].length;s++)u[u.length]=l[t[0]][s]+e[r];return u}if(1===t.length)return[t[0]];for(var e=n(t.substring(1,t.length)),u=[],r=0;r<e.length;r++)u[u.length]=t[0]+e[r];return u};return n(this.password)},collectKeyboardMatches:function(l){for(var t=[],n=this.password[0],e=0,u=0,r=0;r<this.password.length-1;r++)l.areAdjacent(this.password[r],this.password[r+1])?(n+=this.password[r+1],this.password[r+1]!==this.password[r]&&e++):(t[t.length]={pattern:n,entropy:this.calculateKeyboardEntropy(n,e,l),start:u,end:r,type:"keyboard"},n=this.password[r+1],e=0,u=r+1);return n.length>0&&(t[t.length]={pattern:n,entropy:this.calculateKeyboardEntropy(n,e,l),start:u,end:this.password.length-1,type:"keyboard"}),t},calculateKeyboardEntropy:function(l,t,n){var e=1;return this.regex.lower.test(l[0])?e=this.LOWER:this.regex.upper.test(l[0])?e=this.UPPER:this.regex.number.test(l[0])?e=this.NUMBER:this.regex.punctuation.test(l[0])&&(e=this.PUNCTUATION),this.lg(e)+t*this.lg(n.averageNeighbours)},collectRepetitionMatches:function(){for(var l=[],t=this.password.match(this.regex.repetition.single)||[],n=0;n<t.length;n++)l[l.length]={pattern:t[n],entropy:this.calculateSingleRepetitionEntropy(t[n]),start:this.password.indexOf(t[n]),end:this.password.indexOf(t[n])+t[n].length-1,type:"repetition"};for(var e=this.password.match(this.regex.repetition.group)||[],n=0;n<e.length;n++)l[l.length]={pattern:e[n],entropy:this.calculateGroupRepetitionEntropy(e[n]),start:this.password.indexOf(e[n]),end:this.password.indexOf(e[n])+e[n].length-1,type:"repetition"};return l},calculateSingleRepetitionEntropy:function(l){return this.regex.number.test(l)?this.lg(this.NUMBER*l.length):this.regex.lower.test(l)||this.regex.upper.test(l)?this.lg(this.LOWER*l.length):this.regex.punctuation.test(l)?this.lg(this.PUNCTUATION*l.length):this.calculateBruteForceEntropy(l)},calculateGroupRepetitionEntropy:function(l){for(var t=this.regex.repetition.group.exec(l),n=l.length;null!==t;)n=t[1].length,t=this.regex.repetition.group.exec(t[1]);var e=0;return this.regex.number.test(l)&&(e+=this.NUMBER),(this.regex.lower.test(l)||this.regex.upper.test(l))&&(e+=this.LOWER),this.regex.punctuation.test(l)&&(e+=this.PUNCTUATION),this.lg(e*n)},collectSequenceMatches:function(){for(var l="",t="",n="",e="",u=0;u<this.password.length;u++)for(var r=u+2;r<=this.password.length;r++){var s=this.password.substring(u,r),i=s.toLowerCase(),a=this.getReversedString(i);0!==i.length&&(this.sequences.lower.indexOf(i)>=0&&i.length>l.length&&(l=s),this.sequences.lower.indexOf(a)>=0&&i.length>t.length&&(t=s),this.sequences.numbers.indexOf(i)>=0&&i.length>n.length&&(n=s),this.sequences.numbers.indexOf(a)>=0&&i.length>n.length&&(e=s))}var h=[];return l.length>0&&(h[h.length]={pattern:l,entropy:this.calculateSequenceEntropy(l),start:this.password.indexOf(l),end:this.password.indexOf(l)+l.length-1,type:"sequence"}),t.length>0&&(h[h.length]={pattern:t,entropy:this.calculateSequenceEntropy(t),start:this.password.indexOf(t),end:this.password.indexOf(t)+t.length-1,type:"sequence"}),n.length>0&&(h[h.length]={pattern:n,entropy:this.calculateSequenceEntropy(n),start:this.password.indexOf(n),end:this.password.indexOf(n)+n.length-1,type:"sequence"}),e.length>0&&(h[h.length]={pattern:e,entropy:this.calculateSequenceEntropy(e),start:this.password.indexOf(e),end:this.password.indexOf(e)+e.length-1,type:"sequence"}),h},calculateSequenceEntropy:function(l){return this.regex.number.test(l)?this.lg(l.length*this.NUMBER):this.regex.lowerOnly.test(l)?this.lg(l.length*this.LOWER):this.regex.upperOnly.test(l)?this.lg(l.length*this.LOWER):this.regex.upper.test(l)&&this.regex.upper.test(l)?this.lg(l.length*(this.LOWER+this.UPPER)):this.calculateBruteForceEntropy(l)},calculateReversedSequenceEntropy:function(l){return this.calculateSequenceEntropy(l)+1},collectDateMatches:function(){var l=[];for(var t in this.regex.date)for(var n=this.password.match(this.regex.date[t])||[],e=0;e<n.length;e++)if(n[e].length>0){var u=this.password.indexOf(n[e]);l[l.length]={pattern:n[e],entropy:this.calculateDateEntropy(n[e],t),start:u,end:u+n[e].length-1,type:"date"}}return l},calculateDateEntropy:function(l,t){switch(t){case"DMY":case"MDY":case"YDM":case"YMD":return this.lg(this.DAYS*this.MONTHS*10*10);case"DMYY":case"MDYY":case"YYDM":case"YYMD":return this.lg(this.DAYS*this.MONTHS*this.YEARS);case"DM":return this.lg(this.DAYS*this.MONTHS);case"MY":return this.lg(10*this.MONTHS*10);case"MYY":return this.lg(this.MONTHS*this.YEARS)}return this.calculateBruteForceEntropy(l)},getReversedString:function(l){return l.split("").reverse().join("")}};