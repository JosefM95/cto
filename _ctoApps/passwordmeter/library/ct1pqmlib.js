"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(e,a){function s(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}(),Password=function(){function t(e){this.amountOfLowercaseLetters=0,this.amountOfUppercaseLetters=0,this.amountOfDigits=0,this.amountOfSpecialCharacters=0,this.characters=e.replace(/ /g,""),this.length=this.characters.length;for(var a=this.characters.split(""),s=0;s<a.length;s++)t.charIsLowercaseLetter(a[s])?this.amountOfLowercaseLetters++:t.charIsUppercaseLetter(a[s])?this.amountOfUppercaseLetters++:t.charIsDigit(a[s])?this.amountOfDigits++:this.amountOfSpecialCharacters++}return t.convertToWindows1252Value=function(t){for(var e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,8364,65533,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,65533,381,65533,65533,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,65533,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],a={},s=0;s<e.length;++s)a[String.fromCharCode(e[s])]=s;var r=t.charAt(0);return r in a||(r="?"),a[r]},t.convertToAsciiCharValue=function(e){var a=t.convertToWindows1252Value(e);return a>=128&&a<=255&&(a-=256),a},t.charIsLowercaseLetter=function(t){return/[a-z]/.test(t)},t.charIsUppercaseLetter=function(t){return/[A-Z]/.test(t)},t.charIsDigit=function(t){return/[0-9]/.test(t)},t.prototype.getCharacters=function(){return this.characters},t.prototype.getLength=function(){return this.length},t.prototype.getAmountOfLowercaseLetters=function(){return this.amountOfLowercaseLetters},t.prototype.getAmountOfUppercaseLetters=function(){return this.amountOfUppercaseLetters},t.prototype.getAmountOfDigits=function(){return this.amountOfDigits},t.prototype.getAmountOfSpecialCharacters=function(){return this.amountOfSpecialCharacters},t}(),PasswordQualifier=function(){function t(t){this.password=new Password(t)}return t.prototype.getPasswordEntropy=function(){return void 0==this.quality?(this.quality=this.getPasswordQuality(),this.getPasswordEntropy()):Math.floor(128*this.quality/100)},t}(),KeepassPasswordQualifier=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getBitsetCharSet=function(t){var a=0;return Password.convertToAsciiCharValue(t)<Password.convertToAsciiCharValue(" ")&&(a=e.keepassChescape),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue("A")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("Z")&&(a=e.keepassChupper),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue("a")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("z")&&(a=e.keepassChlower),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue("0")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("9")&&(a=e.keepassChnumber),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue(" ")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("/")&&(a=e.keepassChsimpleSpecial),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue(":")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("@")&&(a=e.keepassChextSpecial),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue("[")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("`")&&(a=e.keepassChextSpecial),Password.convertToAsciiCharValue(t)>=Password.convertToAsciiCharValue("{")&&Password.convertToAsciiCharValue(t)<=Password.convertToAsciiCharValue("~")&&(a=e.keepassChextSpecial),Password.convertToAsciiCharValue(t)>Password.convertToAsciiCharValue("~")&&(a=e.keepassChhigh),a},e.getBitsetCharSpace=function(t){var a=0;return t&e.keepassChescape&&(a+=60),t&e.keepassChupper&&(a+=26),t&e.keepassChlower&&(a+=26),t&e.keepassChnumber&&(a+=10),t&e.keepassChsimpleSpecial&&(a+=16),t&e.keepassChextSpecial&&(a+=17),t&e.keepassChhigh&&(a+=112),a},e.prototype.getCharSpace=function(){var t=this.password.getCharacters().split(""),a=this.password.getLength();if(0===a)return 0;for(var s=0,r=0;r<a;r++)s|=e.getBitsetCharSet(t[r]);return e.getBitsetCharSpace(s)},e.prototype.getBitQuality=function(){var t=this.getCharSpace();if(0===this.password.getLength()||0===t)return 0;var e=Math.log(t)/Math.log(2);return Math.ceil(e*this.password.getLength())},e.prototype.getPasswordQuality=function(){var t=this.getBitQuality();return t=Math.floor(t>128?100:100*t/128),this.quality=t,t},e.keepassChlower=1,e.keepassChupper=2,e.keepassChnumber=4,e.keepassChsimpleSpecial=8,e.keepassChextSpecial=16,e.keepassChhigh=32,e.keepassChescape=64,e}(PasswordQualifier),MozillaPasswordQualifier=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getPasswordQuality=function(){var t=0,e=this.password.getLength(),a=this.password.getAmountOfDigits(),s=this.password.getAmountOfSpecialCharacters(),r=this.password.getAmountOfUppercaseLetters();return e>=1&&e<=5&&(t+=10*e),e>5&&(t+=50),t-=20,a>=1&&a<=3&&(t+=10*a),a>3&&(t+=30),s>=1&&s<=3&&(t+=15*s),s>3&&(t+=45),r>=1&&r<=3&&(t+=10*r),r>3&&(t+=30),t<0&&(t=0),t>100&&(t=100),t},e.prototype.getPasswordEntropy=function(){},e}(PasswordQualifier),PgpPasswordQualifier=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.log2=function(t){var e=-1,a=1,s=0;if(!t)return 0;for(;t&e;)e<<=1,a<<=1,s++;return a>>=1,t-a<Math.floor(a/2)&&s--,s},e.getCategory=function(t){for(var a=0,s=e.asciiSpace.length,r=Math.floor((s-a)/2);a<s-1;)if(t<e.asciiSpace[r].base)s=r,r=Math.floor((a+r)/2);else{if(!(t>e.asciiSpace[r].base+e.asciiSpace[r].length-1))return r;a=r,r=Math.floor((s+r)/2)}return t>=e.asciiSpace[a].base&&t<e.asciiSpace[a].base+e.asciiSpace[a].length?a:t>=e.asciiSpace[s].base&&t<e.asciiSpace[s].base+e.asciiSpace[s].length?s:-1},e.getCategoryLength=function(t){var a=e.getCategory(t);return-1!==a?e.asciiSpace[a].totalLength:1},e.prototype.estimateMinEntropyBits=function(){for(var t=0,a=0;a<this.password.getLength();a++)t+=e.log2(e.getCategoryLength(Password.convertToAsciiCharValue(this.password.getCharacters().charAt(a))));return t},e.prototype.estimateMaxEntropyBits=function(){for(var t,a=0,s=0,r=new Array(e.asciiSpace.length),o=0,n=0;n<this.password.getLength();n++)t=e.getCategory(Password.convertToAsciiCharValue(this.password.getCharacters().charAt(n))),-1!==t?(r[t]=!0,t>o&&(o=t)):s++;for(var n=0;n<=o;n++)!0===r[n]&&(a+=e.asciiSpace[n].totalLength,r[n]=!1);return a+=s,this.password.getLength()*e.log2(a)},e.prototype.getPasswordQuality=function(){var t,e=this.estimateMinEntropyBits(),a=this.estimateMaxEntropyBits();return e>a?0:(t=a-e,t=Math.floor(this.password.getLength()?e+t/2:this.password.getLength()/2),t=Math.floor(t>128?100:100*t/128),this.quality=t,t)},e.asciiSpace=[{base:0,length:32,totalLength:32},{base:32,length:1,totalLength:1},{base:33,length:3,totalLength:15},{base:36,length:1,totalLength:1},{base:37,length:3,totalLength:15},{base:40,length:1,totalLength:3},{base:41,length:1,totalLength:3},{base:42,length:1,totalLength:15},{base:43,length:1,totalLength:6},{base:44,length:1,totalLength:15},{base:45,length:1,totalLength:1},{base:46,length:2,totalLength:15},{base:48,length:10,totalLength:10},{base:58,length:2,totalLength:15},{base:60,length:3,totalLength:6},{base:63,length:2,totalLength:15},{base:65,length:26,totalLength:26},{base:91,length:1,totalLength:3},{base:92,length:1,totalLength:15},{base:93,length:1,totalLength:3},{base:94,length:1,totalLength:2},{base:95,length:1,totalLength:1},{base:96,length:1,totalLength:2},{base:97,length:26,totalLength:26},{base:123,length:1,totalLength:3},{base:124,length:1,totalLength:6},{base:125,length:1,totalLength:3},{base:126,length:1,totalLength:6},{base:127,length:33,totalLength:33}],e}(PasswordQualifier);