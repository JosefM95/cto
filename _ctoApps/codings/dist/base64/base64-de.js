"use strict";window.addEventListener("load",function(){function e(){this.encrypt=function(e,t){for(var r="",a=0;a<e.length;a++)r+=e[a].getElementsByClassName("alphabet")[0].value;var n,i,o,s,l,h,c,u="",a=0;for(t=this._utf8_encode(t);a<t.length;)n=t.charCodeAt(a++),i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=n>>2,l=(3&n)<<4|i>>4,h=(15&i)<<2|o>>6,c=63&o,isNaN(i)?h=c=64:isNaN(o)&&(c=64),u=u+r.charAt(s)+r.charAt(l)+r.charAt(h)+r.charAt(c);return u},this.decrypt=function(e,t){for(var r="",a=0;a<e.length;a++)r+=e[a].getElementsByClassName("alphabet")[0].value;var n,i,o,s,l,h,c,u="",a=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");a<t.length;)s=r.indexOf(t.charAt(a++)),l=r.indexOf(t.charAt(a++)),h=r.indexOf(t.charAt(a++)),c=r.indexOf(t.charAt(a++)),n=s<<2|l>>4,i=(15&l)<<4|h>>2,o=(3&h)<<6|c,u+=String.fromCharCode(n),64!=h&&(u+=String.fromCharCode(i)),64!=c&&(u+=String.fromCharCode(o));return u=this._utf8_decode(u)},this._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t},this._utf8_decode=function(e){for(var t="",r=0,a=0,n=0,i=0;r<e.length;)a=e.charCodeAt(r),a<128?(t+=String.fromCharCode(a),r++):a>191&&a<224?(n=e.charCodeAt(r+1),t+=String.fromCharCode((31&a)<<6|63&n),r+=2):(n=e.charCodeAt(r+1),i=e.charCodeAt(r+2),t+=String.fromCharCode((15&a)<<12|(63&n)<<6|63&i),r+=3);return t}}function t(e,t,r){this.algo=e,this.state=t,this.opts=r,this.charToValue=function(e,t){for(var r=t.length,a=0;a<r;++a){var n=t[a].getElementsByClassName("alphabet")[0].value,i=parseInt(t[a].getElementsByClassName("offset")[0].innerText),o=n.indexOf(e);if(o>=0){for(var s=o+i;s<0;)s+=n.length;return s%n.length}}return-1},this.valueToChar=function(e,t){var r=void 0;if(this.opts.$convertToUpcase.prop("checked")&&this.state.$alphabets.length>0)r=this.state.$alphabets[0];else for(var a=this.state.$alphabets.length,n=0;!r&&n<a;++n)this.state.$alphabets[n].getElementsByClassName("alphabet")[0].value.indexOf(t)>=0&&(r=this.state.$alphabets[n]);if(r){var i=r.getElementsByClassName("alphabet")[0].value,o=parseInt(r.getElementsByClassName("offset")[0].innerText);if(i.length){for(e-=o;e<0;)e+=i.length;return e%=i.length,i.substr(e,1)}}return t},this.normalizeKey=function(){var e=[],t=this.state.$key.val(),r=t.length,a=this.state.$keyAlphabets;a||(a=this.state.$alphabets);for(var n=0;n<r;++n){var i=this.charToValue(t[n],a);(i>=0||!this.opts.$skipNonLetterKeys.prop("checked"))&&e.push(i)}return e},this.process=function(e,t){return t?this.algo.encrypt(this.state.$alphabets,e):this.algo.decrypt(this.state.$alphabets,e)}}function r(e){function t(){jQuery("#alphabet-details").modal("hide"),g=null,b=null,C=null}function r(){jQuery("#alphabet-length").text(""+b.val().length)}function n(){b.val(l(jQuery("#compressed-alphabet").val())),r(),a()}function i(e){return function(t){var r=jQuery("#compressed-alphabet");r.val(r.val()+e),n(),t.preventDefault()}}function s(e){if(e.length<3)return e;for(var t="",r=0;r<e.length;)if("-"!==e[r]){var a=e[r].charCodeAt(0),n=r+1;if(n<e.length)if(a===e[n].charCodeAt(0)-1)for(;n<e.length&&a===e[n].charCodeAt(0)-1;)++n,++a;else if(a===e[n].charCodeAt(0)+1)for(;n<e.length&&a===e[n].charCodeAt(0)+1;)++n,--a;if(n-r>=3)t+=e[r]+"-"+e[n-1];else for(var i=r;i<n;++i)t+=e[i];r=n}else t+="---",++r;return t}function l(e){for(var t="",r=0;r<e.length;)if(r+2<e.length&&"-"===e[r+1]){if(e[r].charCodeAt(0)<e[r+2].charCodeAt(0))for(var a=e[r].charCodeAt(0);a<=e[r+2].charCodeAt(0);++a)t+=String.fromCharCode(a);else for(var n=e[r].charCodeAt(0);n>=e[r+2].charCodeAt(0);--n)t+=String.fromCharCode(n);r+=3}else t+=e[r],++r;return t}function h(e){g=e,b=jQuery(".alphabet",e),C=jQuery(".offset",e),jQuery("#compressed-alphabet").val(s(b.val())),jQuery("#keyword-for-alphabet").val(""),jQuery("#offset-for-alphabet").val(C.text()),r(),jQuery("#alphabet-details").modal("show")}function c(e){return function(){var t=jQuery(this),r=t.children("div").first(),n=r.children("input").first();e.push(t.get()[0]),n.on("keyup",a),r.children("span").first().children("button").first().on("click",function(e){h(t),e.preventDefault()})}}function u(t,r,n){var i=jQuery('<div class="form-group"><div class="input-group"><input type="text" class="form-control alphabet"><span class="input-group-btn"><button class="btn btn-default">â€¦</button></span></div><span class="offset">'+n+'</span><div class="alert alert-danger alert-hidden"></div></div>');r.append(i);var o=jQuery("input",i);o.val(t),o.on("keyup",a),jQuery("button",i).on("click",function(e){h(i),e.preventDefault()}),e.$alphabets.push(i.get()[0]),a()}function f(e,t){if(e)for(var r=function(e){for(var t={},r=e.firstChild;r;r=r.nextSibling)for(var a=r.firstChild.firstChild,n=a.value,i=0;i<n.length;++i)t[n[i]]=t[n[i]]?t[n[i]]+1:1;return t}(e),a=e.firstChild;a;a=a.nextSibling){var n=a.firstChild.firstChild,i=n.value,o=a.firstChild.nextSibling.nextSibling,s="";if(0===i.length)s="Alphabet ist leer";else if(t){for(var l="",h=0,c={},u=0;u<i.length;++u)r[i[u]]>1&&(c[i[u]]||(h&&(l+=", "),l+=i[u],c[i[u]]=!0),++h);l.length&&(s=h>1?"Buchstaben $1 werden mehrfach verwendet":"Buchstabe $1 wird mehrfach verwendet",s=s.replace("$1",l))}if(s!==o.innerHTML){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(document.createTextNode(s)),s.length?o.classList.remove("alert-hidden"):o.classList.add("alert-hidden")}}}var p=jQuery("#alphabets"),d=jQuery("#key-alphabets"),v=jQuery("#keyword-for-alphabet");jQuery("#compressed-alphabet").on("keyup",function(){v.val(""),n()}),v.on("keyup",function(){var e=void 0,t="",r=b.val().split("").sort(),a=v.val();for(e=0;e<a.length;++e){var i=r.indexOf(a[e]);i>=0&&(t+=r[i],r.splice(i,1))}for(e=0;e<r.length;++e)t+=r[e];jQuery("#compressed-alphabet").val(s(t)),n()});var y=jQuery("#offset-for-alphabet");y.on("keyup",function(){var e=y.val();e.match(/^[+-]?[0-9]+$/)&&(C.text(e),a())}),jQuery("#alphabet-detail-buttons").children().each(function(){var e=jQuery(this),t=e.prop("id");t&&"add-"===t.substring(0,4)&&e.on("click",i(t.substring(4)))}),jQuery("#reverse-alphabet").on("click",function(e){for(var t="",r=b.val().length-1;r>=0;--r)t+=b.val()[r];jQuery("#compressed-alphabet").val(s(t)),n(),e.preventDefault()}),jQuery("#permute-alphabet").on("click",function(e){for(var t=b.val().split(""),r=t.length-1;r>0;--r){var a=Math.floor(Math.random()*r),i=t[a];t[a]=t[r],t[r]=i}jQuery("#compressed-alphabet").val(s(t.join(""))),n(),e.preventDefault()}),jQuery("#shift-alphabet-left").on("click",function(e){var t=b.val(),r=t.substr(1)+t.substr(0,1);jQuery("#compressed-alphabet").val(s(r)),n(),e.preventDefault()}),jQuery("#shift-alphabet-right").on("click",function(e){var t=b.val(),r=t.substr(t.length-1)+t.substr(0,t.length-1);jQuery("#compressed-alphabet").val(s(r)),n(),e.preventDefault()}),jQuery("#clone-alphabet-to-other-case").on("click",function(e){e.preventDefault();for(var r="",n=b.val(),i=0;i<n.length;++i)n[i]===n[i].toUpperCase()?r+=n[i].toLowerCase():r+=n[i].toUpperCase();u(r,jQuery(g.parent()),parseInt(C.text())),t(),a()}),jQuery("#delete-alphabet").on("click",function(r){e.$alphabets.splice(e.$alphabets.indexOf(b.get()[0]),1),g.remove(),t(),a(),r.preventDefault()});var g=void 0,b=void 0,C=void 0;jQuery(".form-group",p).each(c(e.$alphabets)),d.length&&(e.$keyAlphabets=[],jQuery(".form-group",d).each(c(e.$keyAlphabets))),jQuery("#add-alphabet").on("click",function(e){u("",p),e.preventDefault()});var m=jQuery("#add-key-alphabet");m&&m.on("click",function(e){u("",d),e.preventDefault()}),o=function(){f(p.get()[0],!0),f(d.get()[0],!1)}}function a(){o();var e=s.encrypting?s.$plain:s.$cipher;(s.encrypting?s.$cipher:s.$plain).val(h.process(e.val(),s.encrypting))}var n=new e,i={forEach:function(e,t){for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}},o=void 0,s=new function(){this.encrypting=!0,this.$plain=jQuery("#plain"),this.$cipher=jQuery("#cipher"),this.$key=jQuery("#key"),this.$direction=jQuery("#direction"),this.$alphabets=[],this.$keyAlphabets=void 0,this.setEncrypting=function(){this.encrypting||(this.$direction.removeClass("flip"),this.$direction.addClass("flop"),this.encrypting=!0)},this.setDecrypting=function(){this.encrypting&&(this.$direction.removeClass("flop"),this.$direction.addClass("flip"),this.encrypting=!1)},this.$direction.on("click",function(e){s.encrypting?s.setDecrypting():s.setEncrypting(),e.preventDefault()}),this.$plain.on("keyup",function(){s.setEncrypting(),a()}),this.$cipher.on("keyup",function(){s.setDecrypting(),a()}),this.$key.on("keyup",a)},l=new function(){this.$deleteWhitespace=jQuery("#deleteWhitespace"),this.$groupBy5s=jQuery("#groupBy5s"),this.$deleteNonLetters=jQuery("#deleteNonLetters"),this.$convertToUpcase=jQuery("#convertToUpcase"),this.$skipNonLetterKeys=jQuery("#skipNonLetterKeys"),i.forEach(this,function(e){e.on("change",a)})},h=new t(n,s,l);this.evokeUpdate=function(){a()},function(){r(s);var e=jQuery("#page");e&&e.append(jQuery("#alphabet-details"))}()});