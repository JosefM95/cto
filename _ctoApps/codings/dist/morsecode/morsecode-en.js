"use strict";window.addEventListener("load",function(){function e(){this.encrypt=function(e,a){var t="";a=a.replace(/[^a-zA-Z0-9äöü!@#\$%\^\&*\)\(+=._-\s]/g,""),a=a.toLowerCase();for(var r=a.split(""),s=0;s<r.length;s++)t+=this.enMorse(r[s]);return t},this.decrypt=function(e,a){var t="";a=a.replace(/[^\/\\.\-\s]/g,"");for(var r=a.split(" "),s=0;s<r.length;s++)t+=this.deMorse(r[s]);return t},this.enMorse=function(e){var a="";switch(e){case"a":a+=".- ";break;case"b":a+="-... ";break;case"c":a+="-.-. ";break;case"d":a+="-.. ";break;case"e":a+=". ";break;case"f":a+="..-. ";break;case"g":a+="--. ";break;case"h":a+=".... ";break;case"i":a+=".. ";break;case"j":a+=".--- ";break;case"k":a+="-.- ";break;case"l":a+=".-.. ";break;case"m":a+="-- ";break;case"n":a+="-. ";break;case"o":a+="--- ";break;case"p":a+=".--. ";break;case"q":a+="--.- ";break;case"r":a+=".-. ";break;case"s":a+="... ";break;case"t":a+="- ";break;case"u":a+="..- ";break;case"v":a+="...- ";break;case"w":a+=".-- ";break;case"x":a+="-..- ";break;case"y":a+="-.-- ";break;case"z":a+="--.. ";break;case"1":a+=".---- ";break;case"2":a+="..--- ";break;case"3":a+="...-- ";break;case"4":a+="....- ";break;case"5":a+="..... ";break;case"6":a+="-.... ";break;case"7":a+="--... ";break;case"8":a+="---.. ";break;case"9":a+="----. ";break;case"0":a+="----- ";break;case" ":a+="/ ";break;case".":a+=".-.-.- ";break;case",":a+="--..-- ";break;case"?":a+="..--..  ";break;case"'":a+=".----. ";break;case"!":a+="-.-.-- ";break;case"/":a+="-..-. ";break;case"(":a+="-.--. ";break;case")":a+="-.--.- ";break;case"&":a+=".-... ";break;case"@":a+=".--.-. ";break;case"$":a+="...-..- ";break;case'"':a+=".-..-. ";break;case"_":a+="..--.- ";break;case"-":a+="-....- ";break;case"+":a+=".-.-. ";break;case"=":a+="-...- ";break;case";":a+="-.-.-. ";break;case":":a+="---... ";break;case"ä":a+=".-.- ";break;case"ö":a+="---. ";break;case"ü":a+="..-- "}return a},this.deMorse=function(e){var a="";switch(e){case".-":a="A";break;case"-...":a="B";break;case"-.-.":a="C";break;case"-..":a="D";break;case".":a="E";break;case"..-.":a="F";break;case"--.":a="G";break;case"....":a="H";break;case"..":a="I";break;case".---":a="J";break;case"-.-":a="K";break;case".-..":a="L";break;case"--":a="M";break;case"-.":a="N";break;case"---":a="O";break;case".--.":a="P";break;case"--.-":a="Q";break;case".-.":a="R";break;case"...":a="S";break;case"-":a="T";break;case"..-":a="U";break;case"...-":a="V";break;case".--":a="W";break;case"-..-":a="X";break;case"-.--":a="Y";break;case"--..":a="Z";break;case"-----":a="0";break;case".----":a="1";break;case"..---":a="2";break;case"...--":a="3";break;case"....-":a="4";break;case".....":a="5";break;case"-....":a="6";break;case"--...":a="7";break;case"---..":a="8";break;case"----.":a="9";break;case"/":a=" ";break;case".-.-.-":a=".";break;case"--..--":a=",";break;case"..--..":a="?";break;case".----.":a="'";break;case"-.-.--":a="!";break;case"-..-.":a="/";break;case"-.--.":a="(";break;case"-.--.-":a=")";break;case".-...":a="&";break;case"---...":a=":";break;case"-.-.-.":a=";";break;case"-...-":a="=";break;case".-.-.":a="+";break;case"-....-":a="-";break;case"..--.-":a="_";break;case".-..-.":a='"';break;case"...-..-":a="$";break;case".--.-.":a="@";break;case"---..":a="8";break;case".-.-":a="Ä";break;case"---.":a="Ö";break;case"..--":a="Ü"}return a}}function a(e,a,t){this.algo=e,this.state=a,this.opts=t,this.charToValue=function(e,a){for(var t=a.length,r=0;r<t;++r){var s=a[r].getElementsByClassName("alphabet")[0].value,n=parseInt(a[r].getElementsByClassName("offset")[0].innerText),c=s.indexOf(e);if(c>=0){for(var i=c+n;i<0;)i+=s.length;return i%s.length}}return-1},this.valueToChar=function(e,a){var t=void 0;if(this.opts.$convertToUpcase.prop("checked")&&this.state.$alphabets.length>0)t=this.state.$alphabets[0];else for(var r=this.state.$alphabets.length,s=0;!t&&s<r;++s)this.state.$alphabets[s].getElementsByClassName("alphabet")[0].value.indexOf(a)>=0&&(t=this.state.$alphabets[s]);if(t){var n=t.getElementsByClassName("alphabet")[0].value,c=parseInt(t.getElementsByClassName("offset")[0].innerText);if(n.length){for(e-=c;e<0;)e+=n.length;return e%=n.length,n.substr(e,1)}}return a},this.normalizeKey=function(){var e=[],a=this.state.$key.val(),t=a.length,r=this.state.$keyAlphabets;r||(r=this.state.$alphabets);for(var s=0;s<t;++s){var n=this.charToValue(a[s],r);(n>=0||!this.opts.$skipNonLetterKeys.prop("checked"))&&e.push(n)}return e},this.process=function(e,a){return a?this.algo.encrypt(this.state.$alphabets,e):this.algo.decrypt(this.state.$alphabets,e)}}function t(e){function a(){jQuery("#alphabet-details").modal("hide"),d=null,y=null,g=null}function t(){jQuery("#alphabet-length").text(""+y.val().length)}function s(){y.val(l(jQuery("#compressed-alphabet").val())),t(),r()}function n(e){return function(a){var t=jQuery("#compressed-alphabet");t.val(t.val()+e),s(),a.preventDefault()}}function i(e){if(e.length<3)return e;for(var a="",t=0;t<e.length;)if("-"!==e[t]){var r=e[t].charCodeAt(0),s=t+1;if(s<e.length)if(r===e[s].charCodeAt(0)-1)for(;s<e.length&&r===e[s].charCodeAt(0)-1;)++s,++r;else if(r===e[s].charCodeAt(0)+1)for(;s<e.length&&r===e[s].charCodeAt(0)+1;)++s,--r;if(s-t>=3)a+=e[t]+"-"+e[s-1];else for(var n=t;n<s;++n)a+=e[n];t=s}else a+="---",++t;return a}function l(e){for(var a="",t=0;t<e.length;)if(t+2<e.length&&"-"===e[t+1]){if(e[t].charCodeAt(0)<e[t+2].charCodeAt(0))for(var r=e[t].charCodeAt(0);r<=e[t+2].charCodeAt(0);++r)a+=String.fromCharCode(r);else for(var s=e[t].charCodeAt(0);s>=e[t+2].charCodeAt(0);--s)a+=String.fromCharCode(s);t+=3}else a+=e[t],++t;return a}function o(e){d=e,y=jQuery(".alphabet",e),g=jQuery(".offset",e),jQuery("#compressed-alphabet").val(i(y.val())),jQuery("#keyword-for-alphabet").val(""),jQuery("#offset-for-alphabet").val(g.text()),t(),jQuery("#alphabet-details").modal("show")}function h(e){return function(){var a=jQuery(this),t=a.children("div").first(),s=t.children("input").first();e.push(a.get()[0]),s.on("keyup",r),t.children("span").first().children("button").first().on("click",function(e){o(a),e.preventDefault()})}}function b(a,t,s){var n=jQuery('<div class="form-group"><div class="input-group"><input type="text" class="form-control alphabet"><span class="input-group-btn"><button class="btn btn-default">…</button></span></div><span class="offset">'+s+'</span><div class="alert alert-danger alert-hidden"></div></div>');t.append(n);var c=jQuery("input",n);c.val(a),c.on("keyup",r),jQuery("button",n).on("click",function(e){o(n),e.preventDefault()}),e.$alphabets.push(n.get()[0]),r()}function p(e,a){if(e)for(var t=function(e){for(var a={},t=e.firstChild;t;t=t.nextSibling)for(var r=t.firstChild.firstChild,s=r.value,n=0;n<s.length;++n)a[s[n]]=a[s[n]]?a[s[n]]+1:1;return a}(e),r=e.firstChild;r;r=r.nextSibling){var s=r.firstChild.firstChild,n=s.value,c=r.firstChild.nextSibling.nextSibling,i="";if(0===n.length)i="Alphabet is empty.";else if(a){for(var l="",o=0,h={},b=0;b<n.length;++b)t[n[b]]>1&&(h[n[b]]||(o&&(l+=", "),l+=n[b],h[n[b]]=!0),++o);l.length&&(i=o>1?"characters $1 occur multiple times":"character $1 occurs multiple times",i=i.replace("$1",l))}if(i!==c.innerHTML){for(;c.firstChild;)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(i)),i.length?c.classList.remove("alert-hidden"):c.classList.add("alert-hidden")}}}var u=jQuery("#alphabets"),f=jQuery("#key-alphabets"),k=jQuery("#keyword-for-alphabet");jQuery("#compressed-alphabet").on("keyup",function(){k.val(""),s()}),k.on("keyup",function(){var e=void 0,a="",t=y.val().split("").sort(),r=k.val();for(e=0;e<r.length;++e){var n=t.indexOf(r[e]);n>=0&&(a+=t[n],t.splice(n,1))}for(e=0;e<t.length;++e)a+=t[e];jQuery("#compressed-alphabet").val(i(a)),s()});var v=jQuery("#offset-for-alphabet");v.on("keyup",function(){var e=v.val();e.match(/^[+-]?[0-9]+$/)&&(g.text(e),r())}),jQuery("#alphabet-detail-buttons").children().each(function(){var e=jQuery(this),a=e.prop("id");a&&"add-"===a.substring(0,4)&&e.on("click",n(a.substring(4)))}),jQuery("#reverse-alphabet").on("click",function(e){for(var a="",t=y.val().length-1;t>=0;--t)a+=y.val()[t];jQuery("#compressed-alphabet").val(i(a)),s(),e.preventDefault()}),jQuery("#permute-alphabet").on("click",function(e){for(var a=y.val().split(""),t=a.length-1;t>0;--t){var r=Math.floor(Math.random()*t),n=a[r];a[r]=a[t],a[t]=n}jQuery("#compressed-alphabet").val(i(a.join(""))),s(),e.preventDefault()}),jQuery("#shift-alphabet-left").on("click",function(e){var a=y.val(),t=a.substr(1)+a.substr(0,1);jQuery("#compressed-alphabet").val(i(t)),s(),e.preventDefault()}),jQuery("#shift-alphabet-right").on("click",function(e){var a=y.val(),t=a.substr(a.length-1)+a.substr(0,a.length-1);jQuery("#compressed-alphabet").val(i(t)),s(),e.preventDefault()}),jQuery("#clone-alphabet-to-other-case").on("click",function(e){e.preventDefault();for(var t="",s=y.val(),n=0;n<s.length;++n)s[n]===s[n].toUpperCase()?t+=s[n].toLowerCase():t+=s[n].toUpperCase();b(t,jQuery(d.parent()),parseInt(g.text())),a(),r()}),jQuery("#delete-alphabet").on("click",function(t){e.$alphabets.splice(e.$alphabets.indexOf(y.get()[0]),1),d.remove(),a(),r(),t.preventDefault()});var d=void 0,y=void 0,g=void 0;jQuery(".form-group",u).each(h(e.$alphabets)),f.length&&(e.$keyAlphabets=[],jQuery(".form-group",f).each(h(e.$keyAlphabets))),jQuery("#add-alphabet").on("click",function(e){b("",u),e.preventDefault()});var j=jQuery("#add-key-alphabet");j&&j.on("click",function(e){b("",f),e.preventDefault()}),c=function(){p(u.get()[0],!0),p(f.get()[0],!1)}}function r(){c();var e=i.encrypting?i.$plain:i.$cipher;(i.encrypting?i.$cipher:i.$plain).val(o.process(e.val(),i.encrypting))}var s=new e,n={forEach:function(e,a){for(var t in e)e.hasOwnProperty(t)&&a(e[t],t)}},c=void 0,i=new function(){this.encrypting=!0,this.$plain=jQuery("#plain"),this.$cipher=jQuery("#cipher"),this.$key=jQuery("#key"),this.$direction=jQuery("#direction"),this.$alphabets=[],this.$keyAlphabets=void 0,this.setEncrypting=function(){this.encrypting||(this.$direction.removeClass("flip"),this.$direction.addClass("flop"),this.encrypting=!0)},this.setDecrypting=function(){this.encrypting&&(this.$direction.removeClass("flop"),this.$direction.addClass("flip"),this.encrypting=!1)},this.$direction.on("click",function(e){i.encrypting?i.setDecrypting():i.setEncrypting(),e.preventDefault()}),this.$plain.on("keyup",function(){i.setEncrypting(),r()}),this.$cipher.on("keyup",function(){i.setDecrypting(),r()}),this.$key.on("keyup",r)},l=new function(){this.$deleteWhitespace=jQuery("#deleteWhitespace"),this.$groupBy5s=jQuery("#groupBy5s"),this.$deleteNonLetters=jQuery("#deleteNonLetters"),this.$convertToUpcase=jQuery("#convertToUpcase"),this.$skipNonLetterKeys=jQuery("#skipNonLetterKeys"),n.forEach(this,function(e){e.on("change",r)})},o=new a(s,i,l);this.evokeUpdate=function(){r()},function(){t(i);var e=jQuery("#page");e&&e.append(jQuery("#alphabet-details"))}()});